{"ast":null,"code":"var _jsxFileName = \"/Users/bharath/Documents/Latest_multispeaker/modal/frontend/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport WaveSurfer from 'wavesurfer.js';\nimport './App.css';\nimport { FaPlay, FaPause, FaDownload, FaSpinner, FaExclamationTriangle } from 'react-icons/fa'; // Keep FaGithub if used\nimport { FiExternalLink } from 'react-icons/fi';\n\n// --- Configuration ---\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_ENDPOINT = process.env.REACT_APP_TTS_API_ENDPOINT || 'https://fuchr--orpheus-tts-api-refined-v2-orpheusttsapi-run-fastapi-app.modal.run'; // Replace with your actual endpoint\nconst VEENA_SPEAKER_ID = 'aisha';\nconst PRESET_SENTENCES = [{\n  id: 's1',\n  text: 'कहाँ तक पहुँचे? मैं इंतज़ार कर रहा हूँ।'\n}, {\n  id: 's2',\n  text: 'वीडियो कॉल कर लेंगे, ठीक है?'\n}, {\n  id: 's3',\n  text: 'क्या तुमने आज का मेमो पढ़ा?'\n}, {\n  id: 's4',\n  text: 'अगर ऑर्डर डिलीवर नहीं होता, तो आपका पूरा पैसा वापस कर दिया जाएगा।'\n}, {\n  id: 's5',\n  text: 'पेट्रोल के दाम फिर बढ़ गए क्या?'\n}, {\n  id: 's6',\n  text: 'चलो, वीकेंड में पहाड़ चलते हैं!'\n}, {\n  id: 's7',\n  text: 'यह एक ओपन-सोर्स टेक्स्ट-टू-स्पीच मॉडल है।'\n}, {\n  id: 's8',\n  text: 'माया रिसर्च भारत के लिए AI बना रहा है।'\n}];\nfunction App() {\n  _s();\n  const [text, setText] = useState(PRESET_SENTENCES[0].text);\n  const [selectedPreset, setSelectedPreset] = useState(PRESET_SENTENCES[0].id);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [duration, setDuration] = useState(\"00:00\");\n  const [currentTime, setCurrentTime] = useState(\"00:00\");\n  const waveformRef = useRef(null);\n  const wavesurfer = useRef(null);\n  const audioControlRef = useRef(new Audio()); // Renamed for clarity, this is our control audio element\n\n  useEffect(() => {\n    if (!API_ENDPOINT) {\n      setError('API endpoint (REACT_APP_TTS_API_ENDPOINT) is not configured. Please set it in your environment.');\n      console.error('CRITICAL: REACT_APP_TTS_API_ENDPOINT is not set.');\n    }\n  }, []);\n  const formatTime = time => {\n    if (isNaN(time) || time === Infinity) return \"00:00\";\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  // Initialize WaveSurfer\n  useEffect(() => {\n    if (waveformRef.current && !wavesurfer.current) {\n      wavesurfer.current = WaveSurfer.create({\n        container: waveformRef.current,\n        waveColor: 'rgba(54, 255, 77, 0.3)',\n        progressColor: '#36ff4d',\n        cursorColor: '#ffffff',\n        barWidth: 3,\n        barRadius: 3,\n        responsive: true,\n        height: 100,\n        normalize: true,\n        // Provide the audio element that WaveSurfer will control for playback\n        media: audioControlRef.current\n      });\n      wavesurfer.current.on('ready', () => {\n        // Duration is now available from the controlled media element\n        setDuration(formatTime(wavesurfer.current.getDuration()));\n        // Auto-play if a blob was just loaded\n        if (audioBlob && wavesurfer.current) {\n          // Check audioBlob again here\n          wavesurfer.current.play().catch(e => console.warn(\"Audio autoplay prevented on ready:\", e));\n        }\n      });\n      wavesurfer.current.on('audioprocess', time => {\n        setCurrentTime(formatTime(time));\n      });\n\n      // No need for 'interaction' listener if media is correctly linked,\n      // WaveSurfer handles seeking on the media element.\n\n      wavesurfer.current.on('play', () => setIsPlaying(true));\n      wavesurfer.current.on('pause', () => setIsPlaying(false));\n      wavesurfer.current.on('finish', () => {\n        setIsPlaying(false);\n        wavesurfer.current.seekTo(0);\n        setCurrentTime(\"00:00\"); // Reset current time display\n      });\n    }\n    return () => {\n      if (wavesurfer.current) {\n        wavesurfer.current.destroy();\n        wavesurfer.current = null;\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // audioBlob removed from dependencies here, as loading is handled in the next effect\n\n  // Load audio blob into WaveSurfer and the controlled Audio element\n  useEffect(() => {\n    if (audioBlob && wavesurfer.current) {\n      const audioUrl = URL.createObjectURL(audioBlob);\n      // audioControlRef.current.src = audioUrl; // WaveSurfer's load will handle this for its media element\n      wavesurfer.current.load(audioUrl); // This also sets the src on audioControlRef.current\n\n      return () => {\n        URL.revokeObjectURL(audioUrl);\n      };\n    } else if (!audioBlob && wavesurfer.current) {\n      wavesurfer.current.empty();\n      audioControlRef.current.src = \"\"; // Clear src of our audio element too\n      setDuration(\"00:00\");\n      setCurrentTime(\"00:00\");\n      setIsPlaying(false);\n    }\n  }, [audioBlob]);\n  const handleTextChange = event => {\n    setText(event.target.value);\n    setSelectedPreset('');\n    if (error) setError(null);\n  };\n  const handlePresetChange = event => {\n    const sentenceId = event.target.value;\n    setSelectedPreset(sentenceId);\n    const selectedSentence = PRESET_SENTENCES.find(s => s.id === sentenceId);\n    if (selectedSentence) {\n      setText(selectedSentence.text);\n    }\n    if (error) setError(null);\n  };\n  const handleSubmit = async event => {\n    if (event) event.preventDefault();\n    if (!API_ENDPOINT) {\n      setError('API endpoint is not configured.');\n      return;\n    }\n    if (!text.trim()) {\n      setError('Please enter or select some text to synthesize.');\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    // Setting audioBlob to null will trigger the useEffect above to clear WaveSurfer\n    if (wavesurfer.current && wavesurfer.current.isPlaying()) {\n      wavesurfer.current.stop();\n    }\n    setAudioBlob(null);\n    setIsPlaying(false);\n    setCurrentTime(\"00:00\");\n    setDuration(\"00:00\");\n    const payload = {\n      text: text,\n      speaker_id: VEENA_SPEAKER_ID,\n      output_sample_rate: 24000\n    };\n    try {\n      const response = await axios.post(API_ENDPOINT + '/generate', payload, {\n        responseType: 'blob',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'audio/wav'\n        },\n        timeout: 90000\n      });\n      setAudioBlob(new Blob([response.data], {\n        type: 'audio/wav'\n      }));\n    } catch (err) {\n      console.error('API Error:', err);\n      let errorMessageText = 'An unexpected error occurred during TTS generation.';\n      if (err.response) {\n        if (err.response.data instanceof Blob) {\n          try {\n            const errorBlobText = await err.response.data.text();\n            const errorJson = JSON.parse(errorBlobText);\n            errorMessageText = errorJson.error || errorJson.detail || `Server error: ${err.response.status}`;\n          } catch (e) {\n            errorMessageText = `Server error: ${err.response.status}. Could not parse error response.`;\n          }\n        } else {\n          errorMessageText = err.response.data.error || err.response.data.detail || `Server error: ${err.response.status}`;\n        }\n      } else if (err.request) {\n        errorMessageText = 'No response from the server. It might be down or unreachable.';\n      } else if (err.message) {\n        errorMessageText = err.message;\n      }\n      setError(errorMessageText);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const togglePlayPause = useCallback(() => {\n    if (wavesurfer.current && audioBlob) {\n      // Ensure audioBlob is present\n      wavesurfer.current.playPause();\n    }\n  }, [audioBlob]);\n  const handleDownload = () => {\n    if (audioBlob) {\n      const url = URL.createObjectURL(audioBlob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `veena_tts_maya_research_${text.substring(0, 20).replace(/\\s+/g, '_')}.wav`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"background-animation\",\n      children: Array.from({\n        length: 50\n      }).map((_, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"line\",\n        style: {\n          left: `${Math.random() * 100}%`,\n          animationDuration: `${Math.random() * 5 + 5}s`,\n          animationDelay: `${Math.random() * 5}s`,\n          height: `${Math.random() * 150 + 50}px`\n        }\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content-wrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"App-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"MAYA RESEARCH\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Building AI for India\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"App-main\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tts-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tts-controls-column\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Veena \\u2013 open-source TTS\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"tagline\",\n              children: \"Lifelike Hindi speech, available to everyone.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: handleSubmit,\n              className: \"tts-form\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"preset-select\",\n                  children: \"Select a sample sentence\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                  id: \"preset-select\",\n                  value: selectedPreset,\n                  onChange: handlePresetChange,\n                  disabled: isLoading || !API_ENDPOINT,\n                  className: \"styled-select\",\n                  children: [PRESET_SENTENCES.map(sentence => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: sentence.id,\n                    children: [sentence.text.substring(0, 50), \"...\"]\n                  }, sentence.id, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 258,\n                    columnNumber: 23\n                  }, this)), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    children: \"\\u2014 Type custom text below \\u2014\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 248,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"text-input\",\n                  children: \"Or type your custom Hindi text (max 200 chars)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  id: \"text-input\",\n                  value: text,\n                  onChange: handleTextChange,\n                  placeholder: \"\\u092F\\u0939\\u093E\\u0901 \\u0905\\u092A\\u0928\\u093E \\u0939\\u093F\\u0902\\u0926\\u0940 \\u092A\\u093E\\u0920 \\u0932\\u093F\\u0916\\u0947\\u0902...\",\n                  rows: \"4\",\n                  maxLength: \"200\",\n                  className: \"text-input\",\n                  disabled: isLoading || !API_ENDPOINT,\n                  \"aria-label\": \"Hindi text input\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"generate-button\",\n                disabled: isLoading || !text.trim() || !API_ENDPOINT,\n                \"aria-label\": \"Generate audio\",\n                children: isLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(FaSpinner, {\n                    className: \"spinner-icon\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 287,\n                    columnNumber: 23\n                  }, this), \" GENERATING...\"]\n                }, void 0, true) : 'SYNTHESIZE SPEECH'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tts-player-column\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"glass-card\",\n              children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"error-message\",\n                role: \"alert\",\n                children: [/*#__PURE__*/_jsxDEV(FaExclamationTriangle, {\n                  style: {\n                    marginRight: '10px',\n                    verticalAlign: 'middle'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Error:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 21\n                }, this), \" \", error]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 299,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"sentence-display\",\n                title: \"Synthesized text appears here.\",\n                children: text || \"Your synthesized text will appear here.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                id: \"waveform\",\n                ref: waveformRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 309,\n                columnNumber: 17\n              }, this), (audioBlob || isLoading) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"audio-player-controls-footer\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: togglePlayPause,\n                  className: \"play-pause-button\",\n                  \"aria-label\": isPlaying ? \"Pause\" : \"Play\",\n                  disabled: !audioBlob || isLoading // Disable if no blob or loading\n                  ,\n                  children: isPlaying ? /*#__PURE__*/_jsxDEV(FaPause, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 319,\n                    columnNumber: 38\n                  }, this) : /*#__PURE__*/_jsxDEV(FaPlay, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 319,\n                    columnNumber: 52\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 313,\n                  columnNumber: 22\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"time-indicators-footer\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: currentTime\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 322,\n                    columnNumber: 25\n                  }, this), \" / \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: duration\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 322,\n                    columnNumber: 54\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 321,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handleDownload,\n                  className: \"download-button\",\n                  disabled: !audioBlob || isLoading,\n                  \"aria-label\": \"Download audio\",\n                  children: /*#__PURE__*/_jsxDEV(FaDownload, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 330,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 324,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 19\n              }, this), !isLoading && !audioBlob && !error && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"player-placeholder\",\n                children: \"Synthesize speech to listen and see the waveform.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 336,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"section-separator\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"secondary-content\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"https://mayaresearch.ai\",\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          className: \"secondary-link\",\n          children: [\"Maya Research \", /*#__PURE__*/_jsxDEV(FiExternalLink, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 27\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        className: \"App-footer\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\xA9 \", new Date().getFullYear(), \" Maya Research\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 224,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"/3vNp3NaogeKR1Uet9vTC4EYDpc=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","axios","WaveSurfer","FaPlay","FaPause","FaDownload","FaSpinner","FaExclamationTriangle","FiExternalLink","jsxDEV","_jsxDEV","Fragment","_Fragment","API_ENDPOINT","process","env","REACT_APP_TTS_API_ENDPOINT","VEENA_SPEAKER_ID","PRESET_SENTENCES","id","text","App","_s","setText","selectedPreset","setSelectedPreset","isLoading","setIsLoading","error","setError","audioBlob","setAudioBlob","isPlaying","setIsPlaying","duration","setDuration","currentTime","setCurrentTime","waveformRef","wavesurfer","audioControlRef","Audio","console","formatTime","time","isNaN","Infinity","minutes","Math","floor","seconds","toString","padStart","current","create","container","waveColor","progressColor","cursorColor","barWidth","barRadius","responsive","height","normalize","media","on","getDuration","play","catch","e","warn","seekTo","destroy","audioUrl","URL","createObjectURL","load","revokeObjectURL","empty","src","handleTextChange","event","target","value","handlePresetChange","sentenceId","selectedSentence","find","s","handleSubmit","preventDefault","trim","stop","payload","speaker_id","output_sample_rate","response","post","responseType","headers","timeout","Blob","data","type","err","errorMessageText","errorBlobText","errorJson","JSON","parse","detail","status","request","message","togglePlayPause","playPause","handleDownload","url","a","document","createElement","href","download","substring","replace","body","appendChild","click","removeChild","className","children","Array","from","length","map","_","i","style","left","random","animationDuration","animationDelay","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","htmlFor","onChange","disabled","sentence","placeholder","rows","maxLength","role","marginRight","verticalAlign","title","ref","onClick","rel","Date","getFullYear","_c","$RefreshReg$"],"sources":["/Users/bharath/Documents/Latest_multispeaker/modal/frontend/src/App.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport WaveSurfer from 'wavesurfer.js';\nimport './App.css';\nimport { FaPlay, FaPause, FaDownload, FaSpinner, FaExclamationTriangle } from 'react-icons/fa'; // Keep FaGithub if used\nimport { FiExternalLink } from 'react-icons/fi';\n\n// --- Configuration ---\nconst API_ENDPOINT = process.env.REACT_APP_TTS_API_ENDPOINT || 'https://fuchr--orpheus-tts-api-refined-v2-orpheusttsapi-run-fastapi-app.modal.run'; // Replace with your actual endpoint\nconst VEENA_SPEAKER_ID = 'aisha';\n\nconst PRESET_SENTENCES = [\n  { id: 's1', text: 'कहाँ तक पहुँचे? मैं इंतज़ार कर रहा हूँ।' },\n  { id: 's2', text: 'वीडियो कॉल कर लेंगे, ठीक है?' },\n  { id: 's3', text: 'क्या तुमने आज का मेमो पढ़ा?' },\n  { id: 's4', text: 'अगर ऑर्डर डिलीवर नहीं होता, तो आपका पूरा पैसा वापस कर दिया जाएगा।' },\n  { id: 's5', text: 'पेट्रोल के दाम फिर बढ़ गए क्या?' },\n  { id: 's6', text: 'चलो, वीकेंड में पहाड़ चलते हैं!' },\n  { id: 's7', text: 'यह एक ओपन-सोर्स टेक्स्ट-टू-स्पीच मॉडल है।' },\n  { id: 's8', text: 'माया रिसर्च भारत के लिए AI बना रहा है।' },\n];\n\nfunction App() {\n  const [text, setText] = useState(PRESET_SENTENCES[0].text);\n  const [selectedPreset, setSelectedPreset] = useState(PRESET_SENTENCES[0].id);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [duration, setDuration] = useState(\"00:00\");\n  const [currentTime, setCurrentTime] = useState(\"00:00\");\n\n  const waveformRef = useRef(null);\n  const wavesurfer = useRef(null);\n  const audioControlRef = useRef(new Audio()); // Renamed for clarity, this is our control audio element\n\n  useEffect(() => {\n    if (!API_ENDPOINT) {\n      setError('API endpoint (REACT_APP_TTS_API_ENDPOINT) is not configured. Please set it in your environment.');\n      console.error('CRITICAL: REACT_APP_TTS_API_ENDPOINT is not set.');\n    }\n  }, []);\n  \n  const formatTime = (time) => {\n    if (isNaN(time) || time === Infinity) return \"00:00\";\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  // Initialize WaveSurfer\n  useEffect(() => {\n    if (waveformRef.current && !wavesurfer.current) {\n      wavesurfer.current = WaveSurfer.create({\n        container: waveformRef.current,\n        waveColor: 'rgba(54, 255, 77, 0.3)',\n        progressColor: '#36ff4d',\n        cursorColor: '#ffffff',\n        barWidth: 3,\n        barRadius: 3,\n        responsive: true,\n        height: 100,\n        normalize: true,\n        // Provide the audio element that WaveSurfer will control for playback\n        media: audioControlRef.current, \n      });\n\n      wavesurfer.current.on('ready', () => {\n        // Duration is now available from the controlled media element\n        setDuration(formatTime(wavesurfer.current.getDuration()));\n        // Auto-play if a blob was just loaded\n        if (audioBlob && wavesurfer.current) { // Check audioBlob again here\n          wavesurfer.current.play().catch(e => console.warn(\"Audio autoplay prevented on ready:\", e));\n        }\n      });\n\n      wavesurfer.current.on('audioprocess', (time) => {\n        setCurrentTime(formatTime(time));\n      });\n      \n      // No need for 'interaction' listener if media is correctly linked,\n      // WaveSurfer handles seeking on the media element.\n\n      wavesurfer.current.on('play', () => setIsPlaying(true));\n      wavesurfer.current.on('pause', () => setIsPlaying(false));\n      wavesurfer.current.on('finish', () => {\n        setIsPlaying(false);\n        wavesurfer.current.seekTo(0);\n        setCurrentTime(\"00:00\"); // Reset current time display\n      });\n    }\n\n    return () => {\n      if (wavesurfer.current) {\n        wavesurfer.current.destroy();\n        wavesurfer.current = null;\n      }\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // audioBlob removed from dependencies here, as loading is handled in the next effect\n\n   // Load audio blob into WaveSurfer and the controlled Audio element\n   useEffect(() => {\n    if (audioBlob && wavesurfer.current) {\n      const audioUrl = URL.createObjectURL(audioBlob);\n      // audioControlRef.current.src = audioUrl; // WaveSurfer's load will handle this for its media element\n      wavesurfer.current.load(audioUrl); // This also sets the src on audioControlRef.current\n      \n      return () => {\n        URL.revokeObjectURL(audioUrl);\n      };\n    } else if (!audioBlob && wavesurfer.current) {\n        wavesurfer.current.empty();\n        audioControlRef.current.src = \"\"; // Clear src of our audio element too\n        setDuration(\"00:00\");\n        setCurrentTime(\"00:00\");\n        setIsPlaying(false);\n    }\n  }, [audioBlob]);\n\n\n  const handleTextChange = (event) => {\n    setText(event.target.value);\n    setSelectedPreset('');\n    if (error) setError(null);\n  };\n\n  const handlePresetChange = (event) => {\n    const sentenceId = event.target.value;\n    setSelectedPreset(sentenceId);\n    const selectedSentence = PRESET_SENTENCES.find(s => s.id === sentenceId);\n    if (selectedSentence) {\n      setText(selectedSentence.text);\n    }\n    if (error) setError(null);\n  };\n\n  const handleSubmit = async (event) => {\n    if (event) event.preventDefault();\n    if (!API_ENDPOINT) {\n      setError('API endpoint is not configured.');\n      return;\n    }\n    if (!text.trim()) {\n      setError('Please enter or select some text to synthesize.');\n      return;\n    }\n\n    setIsLoading(true);\n    setError(null);\n    // Setting audioBlob to null will trigger the useEffect above to clear WaveSurfer\n    if (wavesurfer.current && wavesurfer.current.isPlaying()) {\n        wavesurfer.current.stop();\n    }\n    setAudioBlob(null); \n    setIsPlaying(false);\n    setCurrentTime(\"00:00\");\n    setDuration(\"00:00\");\n\n\n    const payload = {\n      text: text,\n      speaker_id: VEENA_SPEAKER_ID,\n      output_sample_rate: 24000,\n    };\n\n    try {\n      const response = await axios.post(API_ENDPOINT + '/generate', payload, {\n        responseType: 'blob',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'audio/wav',\n        },\n        timeout: 90000,\n      });\n      setAudioBlob(new Blob([response.data], { type: 'audio/wav' }));\n    } catch (err)  {\n      console.error('API Error:', err);\n      let errorMessageText = 'An unexpected error occurred during TTS generation.';\n      if (err.response) {\n          if (err.response.data instanceof Blob) {\n              try {\n                  const errorBlobText = await err.response.data.text();\n                  const errorJson = JSON.parse(errorBlobText);\n                  errorMessageText = errorJson.error || errorJson.detail || `Server error: ${err.response.status}`;\n              } catch (e) {\n                  errorMessageText = `Server error: ${err.response.status}. Could not parse error response.`;\n              }\n          } else {\n              errorMessageText = err.response.data.error || err.response.data.detail || `Server error: ${err.response.status}`;\n          }\n      } else if (err.request) {\n          errorMessageText = 'No response from the server. It might be down or unreachable.';\n      } else if (err.message) {\n          errorMessageText = err.message;\n      }\n      setError(errorMessageText);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const togglePlayPause = useCallback(() => {\n    if (wavesurfer.current && audioBlob) { // Ensure audioBlob is present\n      wavesurfer.current.playPause();\n    }\n  }, [audioBlob]);\n\n\n  const handleDownload = () => {\n    if (audioBlob) {\n      const url = URL.createObjectURL(audioBlob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `veena_tts_maya_research_${text.substring(0, 20).replace(/\\s+/g, '_')}.wav`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n    }\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"background-animation\">\n        {Array.from({ length: 50 }).map((_, i) => (\n          <div className=\"line\" key={i} style={{\n            left: `${Math.random() * 100}%`,\n            animationDuration: `${Math.random() * 5 + 5}s`,\n            animationDelay: `${Math.random() * 5}s`,\n            height: `${Math.random() * 150 + 50}px`\n          }}></div>\n        ))}\n      </div>\n      <div className=\"content-wrapper\">\n        <header className=\"App-header\">\n          <h1>MAYA RESEARCH</h1>\n          <p>Building AI for India</p>\n        </header>\n\n        <main className=\"App-main\">\n          <div className=\"tts-container\">\n            <div className=\"tts-controls-column\">\n              <h2>Veena – open-source TTS</h2>\n              <p className=\"tagline\">Lifelike Hindi speech, available to everyone.</p>\n\n              <form onSubmit={handleSubmit} className=\"tts-form\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"preset-select\">Select a sample sentence</label>\n                  <select\n                    id=\"preset-select\"\n                    value={selectedPreset}\n                    onChange={handlePresetChange}\n                    disabled={isLoading || !API_ENDPOINT}\n                    className=\"styled-select\"\n                  >\n                    {PRESET_SENTENCES.map(sentence => (\n                      <option key={sentence.id} value={sentence.id}>{sentence.text.substring(0,50)}...</option>\n                    ))}\n                    <option value=\"\">— Type custom text below —</option>\n                  </select>\n                </div>\n\n                <div className=\"form-group\">\n                  <label htmlFor=\"text-input\">Or type your custom Hindi text (max 200 chars)</label>\n                  <textarea\n                    id=\"text-input\"\n                    value={text}\n                    onChange={handleTextChange}\n                    placeholder=\"यहाँ अपना हिंदी पाठ लिखें...\"\n                    rows=\"4\"\n                    maxLength=\"200\"\n                    className=\"text-input\"\n                    disabled={isLoading || !API_ENDPOINT}\n                    aria-label=\"Hindi text input\"\n                  />\n                </div>\n                \n                <button\n                  type=\"submit\"\n                  className=\"generate-button\"\n                  disabled={isLoading || !text.trim() || !API_ENDPOINT}\n                  aria-label=\"Generate audio\"\n                >\n                  {isLoading ? (\n                    <>\n                      <FaSpinner className=\"spinner-icon\" /> GENERATING...\n                    </>\n                  ) : (\n                    'SYNTHESIZE SPEECH'\n                  )}\n                </button>\n              </form>\n            </div>\n\n            <div className=\"tts-player-column\">\n              <div className=\"glass-card\">\n                {error && (\n                  <div className=\"error-message\" role=\"alert\">\n                    <FaExclamationTriangle style={{ marginRight: '10px', verticalAlign: 'middle' }}/>\n                    <strong>Error:</strong> {error}\n                  </div>\n                )}\n                \n                <div className=\"sentence-display\" title=\"Synthesized text appears here.\">\n                  {text || \"Your synthesized text will appear here.\"}\n                </div>\n                \n                <div id=\"waveform\" ref={waveformRef}></div>\n                \n                {(audioBlob || isLoading) && (\n                  <div className=\"audio-player-controls-footer\">\n                     <button \n                        onClick={togglePlayPause} \n                        className=\"play-pause-button\" \n                        aria-label={isPlaying ? \"Pause\" : \"Play\"}\n                        disabled={!audioBlob || isLoading} // Disable if no blob or loading\n                    >\n                        {isPlaying ? <FaPause /> : <FaPlay />}\n                    </button>\n                    <div className=\"time-indicators-footer\">\n                        <span>{currentTime}</span> / <span>{duration}</span>\n                    </div>\n                    <button \n                        onClick={handleDownload} \n                        className=\"download-button\" \n                        disabled={!audioBlob || isLoading} \n                        aria-label=\"Download audio\"\n                    >\n                        <FaDownload />\n                    </button>\n                  </div>\n                )}\n                \n                {!isLoading && !audioBlob && !error && (\n                  <div className=\"player-placeholder\">\n                      Synthesize speech to listen and see the waveform.\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </main>\n\n        <div className=\"section-separator\"></div>\n\n        <section className=\"secondary-content\">\n          {/* Ensure you have FaGithub imported if you use it here */}\n          <a href=\"https://mayaresearch.ai\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"secondary-link\">\n            Maya Research <FiExternalLink />\n          </a>\n           {/* If you want a GitHub link:\n           <a href=\"https://github.com/your-repo\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"github-button\">\n             <FaGithub /> Contribute on GitHub\n           </a>\n           */}\n        </section>\n\n        <footer className=\"App-footer\">\n          <p>© {new Date().getFullYear()} Maya Research</p>\n        </footer>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}